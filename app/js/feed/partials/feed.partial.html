<link rel="stylesheet" href="css/feed.css"/>

<div ui-view></div>

<div class="col-lg-9 col-md-9 col-sm-9 col-xs-12">
    <!--{{results}}-->
    <div ng-repeat="result in results"
         ng-click="openSplash(this)"
         ng-class="{hasPrice: result.price, hasImage: result.images.length}"
         data-category="{{::result.category}}"
         data-email="{{::result.annotations.source_account}}"
         data-lat="{{::result.location.lat}}"
         data-long="{{::result.location.long}}"
         data-sourceUrl="{{::result.external_url}}"
         data-postDate="{{::result.annotations.original_posting_date}}"
            >
        <div class="thumbnail" style="cursor: pointer">
            <!--<img ng-if="!!result.images.length" ng-repeat="image in result.images" src="{{image.full || image.thumb}}">-->
            <ribbon ng-if="!!result.price" data-price="{{::result.price}}">{{::result.price | currency}}</ribbon>
            <div class="row">
                <!--<div class="col-lg-4 col-lg-offset-4 text-center" data-source="{{::result.source}}">-->
                    <!--{{::result.source}}-->
                <!--</div>-->
                <!--<div class="col-lg-4">-->
                    <!--<div class="row">-->
                        <div class="col-lg-3 col-lg-offset-8 col-md-4 col-md-offset-7 col-sm-6 col-sm-offset-5 col-xs-7 col-xs-offset-3" data-postDate="{{::result.timestamp}}">
                            Posted {{(currentDate - result.timestamp) | secondsToTimeString}} ago.
                        </div>
                        <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2">
                            <hts-fave-toggle></hts-fave-toggle>
                        </div>
                    <!--</div>-->
                <!--</div>-->
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <img ng-if="!!result.images.length" ng-src="{{::result.images[0].full || result.images[0].thumb || result.images[0].images}}" class="img-block">
                </div>
            </div>
            <!--<div ng-if="!result.images.length">No image found</div>-->
            <div class="row">
                <div class="col-lg-12">
                    <div class="caption">
                        <h4 class="heading">{{::result.heading}}</h4>
                        <p class="body">{{::result.body}}</p>
                        <p class="distance" data-distance="{{::result.distanceFromUser}}">
                            <i class="fa fa-location-arrow"></i>&nbsp;{{::result.distanceFromUser | number:0}} mi.
                        </p>
                        <p data-postDate="{{::result.annotations.original_posting_date}}"></p>
                        <p class="text-center">
                            <a href="#" class="btn btn-default btn-lg" role="button">Place Offer</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="col-lg-2 col-md-3 col-sm-3 hidden-xs">
    <div class="affix">
        <input type="text" ng-model="selectedCategory" typeahead="category.name for category in categories | filter:{name:$viewValue} | limitTo:20" typeahead-on-select='categorySelected($item, $model, $label)' class="form-control" placeholder="Add categories to feed" typeahead-template-url="autocompleteCategoryTemplate.html"></input>
    </div>
</div>


<script type="text/ng-template" id="autocompleteCategoryTemplate.html">
    <a>
        <span bind-html-unsafe="match.model.name | typeaheadHighlight:query"></span>
        <span><i> - ({{match.model.group_name}})</i></span>
    </a>
</script>